<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zys.websocketchatroom.mapper.RelationMapper">


    <select id="queryFriendsById" resultType="com.zys.websocketchatroom.pojo.User" parameterType="String">

        select u.userid, u.username, u.avatar from user u where u.userid in (
            select friend_id as friends from Relationship where user_id =#{userid}
            union all select user_id as friends from Relationship where friend_id = #{userid}
            )

    </select>


    <insert id="insertFriend" parameterType="String">
        insert into Relationship values(#userid, #friend_id)
    </insert>

    <select id="queryGroupById" resultType="com.zys.websocketchatroom.pojo.Group" parameterType="String">
        select g.group_id, g.group_name, g.group_head,g.group_count from `group` g where g.group_id in (
            select group_id from groupship where user_id = #{userid}
            )
    </select>

    <insert id="insertGroup" parameterType="String">
        insert into groupship values(#{groupid}, #{userid})
    </insert>

</mapper>